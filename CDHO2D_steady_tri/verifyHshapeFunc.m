function verifyHshapeFunc()

p=5;
n = nIntergerPoints(2,0);
qPoints = TriGaussPoints(n);
nQuadPoints = size(qPoints,1);
for i = 1: nQuadPoints
    IPoint = qPoints(i,:);
    [ ShapeFunc, divShapeFunc ] = HierarchicalShapeFunc(p,IPoint);
    [ SF, divSF ] = HSymbolic(p);
    lam2 = IPoint(1);
    lam3 = IPoint(2);
    symbSF = eval(SF);
    symbdivSF=eval(divSF);
    ShapeFunc-symbSF;
    divShapeFunc-symbdivSF
end
            
end

function [ SF, divSF ] = HSymbolic(p)
syms lam2 lam3
lam1 = 1-lam2-lam3;
if p==2
    SF = [lam1;lam2;lam3;-2*lam1*lam2;-2*lam2*lam3;-2*lam3*lam1];
    divSF(:,1) = diff(SF,lam2);
    divSF(:,2) = diff(SF,lam3);
elseif p==3
    SF = [lam1;lam2;lam3;...
        -2*lam1*lam2;...
        -2*lam1*lam2*(lam2-lam1);...
        -2*lam2*lam3;...
        -2*lam2*lam3*(lam3-lam2);...
        -2*lam3*lam1;...
        -2*lam1*lam3*(lam1-lam3);...        
        lam1*lam2*lam3];
    divSF(:,1) = diff(SF,lam2);
    divSF(:,2) = diff(SF,lam3);
elseif p==4
    SF = [lam1;lam2;lam3;...
        -2*lam1*lam2;...
        -2*lam1*lam2*(lam2-lam1);...
        -2*lam1*lam2*(lam1^2-3*lam1*lam2+lam2^2);...
        -2*lam2*lam3;...
        -2*lam2*lam3*(lam3-lam2);...
        -2*lam2*lam3*(lam2^2-3*lam2*lam3+lam3^2);...
        -2*lam3*lam1;...
        -2*lam1*lam3*(lam1-lam3);...         
        -2*lam1*lam3*(lam3^2-3*lam3*lam1+lam1^2);...
        lam1*lam2*lam3;lam1*lam2*lam3*(lam1-1/3);lam1*lam2*lam3*(lam2-1/3)];
    divSF(:,1) = diff(SF,lam2);
    divSF(:,2) = diff(SF,lam3);
elseif p==5
    SF = [lam1;lam2;lam3;...
        -2*lam1*lam2;...
        -2*lam1*lam2*(lam2-lam1);...
        -2*lam1*lam2*(lam1^2-3*lam1*lam2+lam2^2);...
        -2*lam1*lam2*(lam2^3-6*lam1*lam2^2+6*lam1^2*lam2-lam1^3); ...
        -2*lam2*lam3;...
        -2*lam2*lam3*(lam3-lam2);...
        -2*lam2*lam3*(lam2^2-3*lam2*lam3+lam3^2);...
        -2*lam2*lam3*(lam3^3-6*lam2*lam3^2+6*lam2^2*lam3-lam2^3);...
        -2*lam3*lam1;...
        -2*lam1*lam3*(lam1-lam3);...         
        -2*lam1*lam3*(lam3^2-3*lam3*lam1+lam1^2);...
        -2*lam1*lam3*(lam1^3-6*lam3*lam1^2+6*lam3^2*lam1-lam3^3);...
        lam1*lam2*lam3;...
        lam1*lam2*lam3*(lam1-1/3);...
        lam1*lam2*lam3*(lam2-1/3);...
        lam1*lam2*lam3*[lam1^2-(3/4)*lam1+(3/28);...
        lam1*lam2-(1/4)*(lam1+lam2)+(1/14); lam2^2-(3/4)*lam2+(3/28)]];
    
    divSF(:,1) = diff(SF,lam2);
    divSF(:,2) = diff(SF,lam3);
end

end